<!--
SPDX-FileCopyrightText: Rafał Dzięgiel

SPDX-License-Identifier: LGPL-2.1-or-later
-->

<!DOCTYPE html>
<html lang="en">
<head>
  <title>Clapper &ndash; 0.0: Clapper Enhancers</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta charset="utf-8" />

  
  <meta property="og:type" content="website"/>

  
  <meta property="og:image:width" content="256"/>
  <meta property="og:image:height" content="256"/>
  <meta property="og:image:secure_url" content="clapper-logo.svg"/>
  <meta property="og:image:alt" content="Clapper-0.0"/>
  

  
  <meta property="og:title" content="Clapper: Clapper Enhancers"/>
  <meta property="og:description" content="Reference for Clapper-0.0: Clapper Enhancers"/>
  <meta name="twitter:title" content="Clapper: Clapper Enhancers"/>
  <meta name="twitter:description" content="Reference for Clapper-0.0: Clapper Enhancers"/>


  
  <meta name="twitter:card" content="summary"/>

  
  
  
  <link rel="search" type="application/opensearchdescription+xml" title="Clapper" href="opensearch.xml">
  
  

  <link rel="stylesheet" href="style.css" type="text/css" />

  

  
  <script src="urlmap.js"></script>
  
  
  <script src="fzy.js"></script>
  <script src="search.js"></script>
  
  <script src="main.js"></script>

  
</head>

<body>
  <div id="body-wrapper" tabindex="-1">

    <nav class="sidebar devhelp-hidden">
      
      <div class="section">
        <a href="index.html"><img src="clapper-logo.svg" class="logo"/></a>
      </div>
      
      
      <div class="search section">
        <form id="search-form" autocomplete="off">
          <input id="search-input" type="text" name="do-not-autocomplete" placeholder="Click, or press 's' to search" autocomplete="off"/>
        </form>
      </div>
      
      <div class="section namespace">
        <h3><a href="index.html">Clapper</a></h3>
        <p>API Version: 0.0</p>
        
        <p>Library Version: 0.9.1</p>
        
      </div>
      
      
      <div class="section generator">
        <p>Generated by <a href="https://gitlab.gnome.org/GNOME/gi-docgen">gi-docgen</a> 2025.4</p>
      </div>
    </nav>

    <button id="btn-to-top" class="hidden"><span class="up-arrow"></span></button>

    
<section id="main" class="content">
  
  <h4 id="title" style="display:flex;">
    Clapper Enhancers
    <a href="#title" class="anchor"></a>
    
  </h4>
  
  <section>
    <div class="docblock">
    <h3 id="overview">Overview<a class="md-anchor" href="#overview" title="Permanent link"></a></h3>
<p>Clapper Enhancers are special plugins loaded through <code>libpeas</code> for Clapper library.
The idea is to enhance it (including applications that use Clapper) with new
capabilities that do stuff outside of <code>GStreamer</code> scope of things without increasing
number of dependencies of Clapper itself (especially for features that not everyone&nbsp;needs).</p>
<p>To avoid confusion with term &#8220;plugins&#8221; that <code>GStreamer</code> uses, the name &#8220;enhancers&#8221;
was choosen&nbsp;instead.</p>
<p>In addition to writing enhancers in pure <code>C</code>, they can be written in any programmable
language that is supported by <code>libpeas</code> and works with Clapper library bindings
(examples being <code>Python</code>, <code>GJS</code> and <code>Vala</code>). This makes it possible for individual users
to add their own custom functionalities that they want to use&nbsp;individually.</p>
<h3 id="types">Types<a class="md-anchor" href="#types" title="Permanent link"></a></h3>
<p>Clapper gives three interfaces for writing enhancers for different things, these&nbsp;are:</p>
<ul>
<li><a href="extractable-enhancers.html">Extractable</a></li>
<li><a href="playlistable-enhancers.html">Playlistable</a></li>
<li><a href="reactable-enhancers.html">Reactable</a></li>
</ul>
<h3 id="basics">Basics<a class="md-anchor" href="#basics" title="Permanent link"></a></h3>
<p>Each enhancer is a <code>libpeas</code> compatible module. As such it follows its requirements for
writing plugins and is a <a href="javascript:void(0)" data-namespace="GObject" data-link="class.Object.html" class="external"><code>GObject</code></a> sublass implementing one or more of interfaces
that Clapper library&nbsp;provides.</p>
<p>Due to the plugins nature, written enhancer can be either submitted to the main <a href="https://github.com/Rafostar/clapper-enhancers">Clapper Enhancers
repository</a> when it seems useful for more than a single
application. Alternatively, it can be shipped as part your application. Users can also write their
own/custom local enhancer&nbsp;plugins.</p>
<h3 id="loading-enhancers">Loading Enhancers<a class="md-anchor" href="#loading-enhancers" title="Permanent link"></a></h3>
<p>Clapper will try to lazy load enhancer modules, meaning they will not be loaded unless they are used.
As an additional safety precaution, enhancers can be disallowed from their instances being created with
<a href="property.EnhancerProxy.target-creation-allowed.html"><code>ClapperEnhancerProxy:target-creation-allowed</code></a>. Enhancers that operate on-demand
(when supported <span class="caps">URI</span> is given) such as <a href="iface.Extractable.html"><code>ClapperExtractable</code></a> and <a href="iface.Playlistable.html"><code>ClapperPlaylistable</code></a>
are allowed (enabled) by default, while <a href="iface.Reactable.html"><code>ClapperReactable</code></a> are&nbsp;not.</p>
<p>Environment&nbsp;variables:</p>
<ul>
<li><code>CLAPPER_ENHANCERS_PATH</code> - override for default path where Clapper loads enhancers&nbsp;from</li>
<li><code>CLAPPER_ENHANCERS_EXTRA_PATH</code> - additional path to scan for enhancer&nbsp;plugins</li>
</ul>
<p>While both allow to specify multiple directories (with <code>:</code> separation), applications and
users should mostly use extra path in order to add their own enhancers from non-standard
installation directory. They can override default path in case where they want to forbid
using stock enhancers for some&nbsp;reason.</p>
<h3 id="enhancer-proxies">Enhancer Proxies<a class="md-anchor" href="#enhancer-proxies" title="Permanent link"></a></h3>
<p>In order to create enhancers when needed and use them only within thread they were created in,
Clapper manages enhancer instances on its own. It gives applications proxy objects for
browsing and configuring&nbsp;them.</p>
<p>Only after Clapper library is initialized, you can get either the global (application scope) list
(<a href="class.EnhancerProxyList.html"><code>ClapperEnhancerProxyList</code></a>) of enhancers proxies with <a href="func.get_global_enhancer_proxies.html"><code>clapper_get_global_enhancer_proxies()</code></a>
or player scope with <a href="method.Player.get_enhancer_proxies.html"><code>clapper_player_get_enhancer_proxies()</code></a>.</p>
<p>Properties set on the global list will carry over to all created player instances afterwards.
While these set on a list from a player are applied to enhancers created by this player only.
You can use that to your advantage to only allow creation of some type of enhancer in only some
player&nbsp;instances.</p>
<h3 id="properties">Properties<a class="md-anchor" href="#properties" title="Permanent link"></a></h3>
<p>Some enhancers might want to expose some configuration. For this cases they should install
<a href="javascript:void(0)" data-namespace="GObject" data-link="class.Object.html" class="external"><code>GObject</code></a> properties in their class. They must only use fundamental types from the list&nbsp;below:</p>
<ul>
<li>boolean</li>
<li>int</li>
<li>uint</li>
<li>double</li>
<li>string</li>
</ul>
<p>They should include one or more of <a href="flags.EnhancerParamFlags.html"><code>ClapperEnhancerParamFlags</code></a>.
Properties in object can have <code>global</code>, <code>local</code>, neither or both flags at&nbsp;once.</p>
<p>The ones with [Clapper.EnhancerParamFlags.<span class="caps">GLOBAL</span>] are for user to configure. They should
be exposed (ideally in the <span class="caps">UI</span>) and used for things that make sense to be set for all
applications at once (e.g. supported media codec by user device, preferred language,&nbsp;etc.).</p>
<p>On the other hand, properties with [Clapper.EnhancerParamFlags.<span class="caps">LOCAL</span>] are for application scope
usage only. They never carry over to other apps, nor they can be set on global enhancers list.
Instead they are configured per player&nbsp;instance.</p>
<p>When property is neither <code>global</code> or <code>local</code> it is considered to be plugin internal property.
Clapper will never access them, as such they can be of any type (not limited to above list).
This also makes properties that are already installed in base classes of subclassed object
not appear in the <span class="caps">UI</span>.</p>
<p>When both flags are set, property will initially use globally set value by user while still
allowing application to override this value locally per player&nbsp;instance.</p>
<p>Extra flags like [Clapper.EnhancerParamFlags.<span class="caps">FILEPATH</span>] and [Clapper.EnhancerParamFlags.<span class="caps">DIRPATH</span>]
can be used (usually with <code>string</code> type of property) in order to let application know that this
field holds a file/directory path and allow it to present file selection dialog to the user instead
of text&nbsp;entry.</p>
<h3 id="configuring-enhancers">Configuring Enhancers<a class="md-anchor" href="#configuring-enhancers" title="Permanent link"></a></h3>
<p>Applications browse properties of enhancer via <a href="method.EnhancerProxy.get_target_properties.html"><code>clapper_enhancer_proxy_get_target_properties()</code></a>
which returns a list of <a href="javascript:void(0)" data-namespace="GObject" data-link="class.ParamSpec.html" class="external"><code>GParamSpec</code></a>. By inspecting their <code>flags</code> application can know
whether property is <code>global</code>, <code>local</code> or&nbsp;both.</p>
<p>Use <a href="method.EnhancerProxy.get_settings.html"><code>clapper_enhancer_proxy_get_settings()</code></a> to get a <a href="javascript:void(0)" data-namespace="Gio" data-link="class.Settings.html" class="external"><code>GSettings</code></a> with <code>global</code> properties
to read and write (note that only users should be able to change them, thus you might want to bind these
into some <span class="caps">UI</span> widgets for that). These can be (with user consent) set on either proxy from global proxies
list or the player&nbsp;one.</p>
<p>Use <a href="method.EnhancerProxy.set_locally.html"><code>clapper_enhancer_proxy_set_locally()</code></a> to set <code>local</code> properties. These are meant for applications
to freely customize as they please. Remember that you can only set them on a enhancer proxy object belonging
to some player instance and not the global&nbsp;one.</p>
<h3 id="plugin-info-file">Plugin Info File<a class="md-anchor" href="#plugin-info-file" title="Permanent link"></a></h3>
<p>An enhancer plugin should be placed within directory that includes its [Peas] plugin
description file. It should be a text file with a <code>.plugin</code> extension and contain at least
following&nbsp;content:</p>
<div class="codehilite"><pre><span></span><code>[Plugin]
Module=example_enhancer
Name=Example Enhancer
Description=This enhancer serves as an example
Version=0.0.1
</code></pre></div>

<ul>
<li><code>Module</code> - module entry file name. It also acts as enhancer <span class="caps">ID</span> and should be unique for each.
It is recommended to use app/custom prefix in its&nbsp;name.</li>
<li><code>Name</code> - module friendly name for displaying in <span class="caps">UI</span> and&nbsp;such.</li>
<li><code>Description</code> - description to present to the user for what it&nbsp;does.</li>
<li><code>Version</code> - enhancer version. In order to lazy load enhancers, Clapper will cache each
enhancer data and olny reload it if version changes, so keep this always&nbsp;updated.</li>
</ul>
<p>If module is written in interpretable programming language it must also contain <code>Loader</code> key
with interpreter name (e.g. <code>Loader=python</code>).</p>
<p>Some enhancer interfaces require additional fields to be put in this file. They are described
in the requirements of each one in their documentation pages that are listed in the
<a href="clapper-enhancers.html#types">Types section</a>.</p>
<h3 id="adding-enhancers-to-flatpak-app">Adding Enhancers to Flatpak App<a class="md-anchor" href="#adding-enhancers-to-flatpak-app" title="Permanent link"></a></h3>
<p>If you are using Clapper as part of a <code>Flatpak</code> application, you can get all the enhancers from their main repo as an extension
(info <a href="https://github.com/flathub/com.github.rafostar.Clapper?tab=readme-ov-file#comgithubrafostarclapperenhancers">here</a>),
thus you do not need to build them&nbsp;yourself.</p>
    </div>
  </section>
</section>


    
<div id="toc" class="toc">
  <nav aria-labelledby="toc-title">
    <p id="toc-title">Content</p>
    <ul class="toc-list">
      
        
        <li class="toc-list-item"><a href="#overview"><span class="link-text">Overview</span></a></li>
          
        
        <li class="toc-list-item"><a href="#types"><span class="link-text">Types</span></a></li>
          
        
        <li class="toc-list-item"><a href="#basics"><span class="link-text">Basics</span></a></li>
          
        
        <li class="toc-list-item"><a href="#loading-enhancers"><span class="link-text">Loading Enhancers</span></a></li>
          
        
        <li class="toc-list-item"><a href="#enhancer-proxies"><span class="link-text">Enhancer Proxies</span></a></li>
          
        
        <li class="toc-list-item"><a href="#properties"><span class="link-text">Properties</span></a></li>
          
        
        <li class="toc-list-item"><a href="#configuring-enhancers"><span class="link-text">Configuring Enhancers</span></a></li>
          
        
        <li class="toc-list-item"><a href="#plugin-info-file"><span class="link-text">Plugin Info File</span></a></li>
          
        
        <li class="toc-list-item"><a href="#adding-enhancers-to-flatpak-app"><span class="link-text">Adding Enhancers to Flatpak App</span></a></li>
          
        
      
    </ul>
  </nav>
</div>


    <section id="search" class="content hidden"></section>

    <footer>
    
    </footer>
  </div>
</body>
</html>